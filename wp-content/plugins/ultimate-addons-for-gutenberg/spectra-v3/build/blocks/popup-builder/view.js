(()=>{const{store:e,getContext:t,getElement:o}=window.wp?.interactivity||{};window.UAGBPopupBuilder=window.UAGBPopupBuilder||{popups:new Map,initialized:!1};const n=new Set;function i(e){const t=["button:not([disabled])","[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'].join(", ");return Array.from(e.querySelectorAll(t)).filter((e=>{const t=window.getComputedStyle(e);return null!==e.offsetParent&&!e.hasAttribute("aria-hidden")&&"hidden"!==t.visibility&&"none"!==t.display}))}function p(){document.body.classList.toggle("spectra-popup-active",n.size>0)}function s(e,t,o="popup"){if(e.setAttribute("aria-hidden",t?"false":"true"),t)return"popup"===o?(e.setAttribute("aria-modal","true"),e.setAttribute("role","dialog")):e.setAttribute("role","region"),void e.setAttribute("tabindex","-1");e.removeAttribute("aria-modal"),e.removeAttribute("role"),e.removeAttribute("tabindex")}function r(e,t){const o=e.getAttribute("data-popup-context"),n=o?JSON.parse(o):{},i=n.popupId||t,{repetition:p,infinite:s}=function(e,t={}){const o=e.getAttribute("data-repetition"),n=e.getAttribute("data-repeat-infinitely");let i=1,p=!1;return null!==o?(i=parseInt(o,10),p=-1===i||"true"===n):void 0!==t.repetition&&(i=parseInt(t.repetition,10),p=!0===t.repeatInfinitely||-1===i),{repetition:p?-1:i,infinite:p}}(e,n),r=function(e,t,o){const n=`spectraPopup${e}`;let i=JSON.parse(localStorage.getItem(n));return o?(i&&-1===i[1]||(i=[-1,-1],localStorage.setItem(n,JSON.stringify(i))),{shouldShow:!0,updateSession:()=>{}}):(i&&i[1]===t||(i=[t,t],localStorage.setItem(n,JSON.stringify(i))),{shouldShow:i[0]>0,updateSession:()=>{i[0]>0&&(i[0]--,localStorage.setItem(n,JSON.stringify(i)))}})}(i,p,s);return r.shouldShow?{element:e,blockId:t,popupId:i,isOpen:!1,sessionManager:r,config:{variantType:n.variantType||"popup",isDismissable:!1!==n.isDismissable,hasOverlay:!1!==n.hasOverlay,closeIcon:!1!==n.closeIcon,closeOverlayClick:!1!==n.closeOverlayClick,closeEscapePress:!1!==n.closeEscapePress,haltBackgroundInteraction:!1!==n.haltBackgroundInteraction,willPushContent:!1!==n.willPushContent,repeatInfinitely:s,repetition:p}}:(e.remove(),null)}function l(e){const{element:t,config:o}=e,n="banner"===o.variantType&&o.willPushContent;t.style.display="flex",e.isOpen=!0,e.previousActiveElement=document.activeElement,s(t,!0,o.variantType),setTimeout((()=>{if(n)t.style.maxHeight="100vh",setTimeout((()=>{t.style.transition="max-height 0.5s cubic-bezier(0, 1, 0, 1)"}),600);else{if("popup"===o.variantType&&o.haltBackgroundInteraction){document.body.classList.add("spectra-popup-builder__body--overflow-hidden"),t.classList.add("spectra-popup--open");const e=i(t);e.length>0?e[0].focus():(t.setAttribute("tabindex","-1"),t.focus())}else t.setAttribute("tabindex","-1"),t.focus();!function(e,t,o="popup"){const n=n=>{if("Escape"===n.key)return n.preventDefault(),void t();if("popup"===o&&"Tab"===n.key){const t=i(e);if(0===t.length)return;const o=t[0],p=t[t.length-1],s=document.activeElement;n.shiftKey?s===o&&(n.preventDefault(),p.focus()):s===p&&(n.preventDefault(),o.focus())}};document.addEventListener("keydown",n,!0),e._keydownHandler=n}(t,(()=>u(e.blockId)),o.variantType),t.style.opacity="1"}}),100)}function u(e){const t=window.UAGBPopupBuilder.popups.get(e);if(!t?.isOpen)return;const{element:o,config:i,sessionManager:r}=t,l="banner"===i.variantType&&i.willPushContent;n.delete(e),p(),s(o,!1,i.variantType),r.updateSession(),o._keydownHandler&&(document.removeEventListener("keydown",o._keydownHandler,!0),delete o._keydownHandler),l?o.style.maxHeight="":o.style.opacity="0",setTimeout((()=>{if(l&&(o.style.transition=""),t.previousActiveElement&&document.contains(t.previousActiveElement)&&"function"==typeof t.previousActiveElement.focus)try{t.previousActiveElement.focus()}catch(e){document.body.focus()}o.remove(),document.querySelector(".spectra-popup-builder.spectra-popup--open")||document.body.classList.remove("spectra-popup-builder__body--overflow-hidden"),t.escHandler&&document.removeEventListener("keyup",t.escHandler),t.isOpen=!1,window.UAGBPopupBuilder.popups.delete(e),document.dispatchEvent(new CustomEvent("spectra:popup:closed",{detail:{blockId:e},bubbles:!0}))}),l?500:100)}function a(e){const{element:t,blockId:o,popupId:n,config:i}=e;if(!i.isDismissable)return;const p=()=>u(o);if(i.closeIcon){const e=t.querySelector('.spectra-popup-builder__close, [data-close-popup="true"]');e&&(e.style.cursor="pointer",e.addEventListener("click",p),e.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),p())})))}i.hasOverlay&&i.closeOverlayClick&&t.addEventListener("click",(e=>{(e.target===t||e.target.classList.contains("spectra-popup-builder__overlay"))&&p()}));const s=document.querySelectorAll(`.spectra-popup-close-${n}`);s.length&&s.forEach((e=>{e.style.cursor="pointer",e.addEventListener("click",p)}))}function c(e){const t=Array.from(e.classList).find((e=>e.startsWith("spectra-block-")));if(!t)return;const o=t.replace(/^(spectra)-block-/,"");if(window.UAGBPopupBuilder.popups.has(o))return;const n=r(e,o);n&&(window.UAGBPopupBuilder.popups.set(o,n),l(n),a(n))}function d(){window.UAGBPopupBuilder.initialized||(document.querySelectorAll(['.spectra-popup-builder[class*="spectra-block-"]','[class*="spectra-block-"].spectra-popup-builder'].join(", ")).forEach(c),window.UAGBPopupBuilder.initialized=!0)}let b={};if(void 0!==e&&void 0!==t&&void 0!==o){const i=e("spectra/popup-builder",{actions:{open(){const{blockId:e}=t(),{ref:i}=o();let s=window.UAGBPopupBuilder.popups.get(e);if(!s){if(s=r(i,e),!s)return;window.UAGBPopupBuilder.popups.set(e,s)}l(s),a(s),n.add(e),p(),document.dispatchEvent(new CustomEvent("spectra:popup:opened",{detail:{blockId:e},bubbles:!0}))},close(){const{blockId:e}=t();u(e)},toggle(){const{blockId:e}=t(),o=window.UAGBPopupBuilder.popups.get(e);o?.isOpen?i.actions.close():i.actions.open()}},callbacks:{initialize(){const e=t(),{ref:n}=o(),{blockId:i}=e;s(n,!1),setTimeout((()=>{c(n),n.dispatchEvent(new CustomEvent("spectra:popup:initialized",{detail:{blockId:i,context:e},bubbles:!0}))}),0)}}});b=i.actions}else b={open:()=>{},close:()=>{},toggle:()=>{}};window.UAGBPopupBuilder.actions=b,window.UAGBPopupBuilder.api={close:u,getPopup:e=>window.UAGBPopupBuilder.popups.get(e),getAllPopups:()=>Array.from(window.UAGBPopupBuilder.popups.values()),resetSession:e=>localStorage.removeItem(`spectraPopup${e}`),isInfinite:e=>window.UAGBPopupBuilder.popups.get(e)?.config?.repeatInfinitely||!1,open:e=>{const t=window.UAGBPopupBuilder.popups.get(e);t&&(l(t),a(t),n.add(e),p())},toggle:e=>{const t=window.UAGBPopupBuilder.popups.get(e);t&&(t.isOpen?u(e):window.UAGBPopupBuilder.api.open(e))}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d()})();